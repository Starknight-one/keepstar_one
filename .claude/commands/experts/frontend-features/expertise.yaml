# Frontend Features Expertise
# Feature modules - chat, catalog, overlay, canvas

overview:
  layer: "features"
  path: "project/frontend/src/features/"
  imports: "shared/, entities/"
  contains: "Feature modules with model + hooks + components"

features:
  chat:
    path: "src/features/chat/"
    status: "implemented"
    files:
      - "chatModel.js - createInitialChatState()"
      - "useChatMessages.js - State management"
      - "useChatSubmit.js - API submission"
      - "sessionCache.js - localStorage session cache (save/load/clear, 30min TTL)"
      - "ChatPanel.jsx - Main component"
      - "ChatHistory.jsx - Message list"
      - "ChatInput.jsx - Input field"
      - "ChatPanel.css - Styles"
    hooks:
      useChatMessages:
        returns: ["sessionId", "messages", "isLoading", "error", "addMessage", "setMessages", "setLoading", "setError", "setSessionId"]
      useChatSubmit:
        params: ["sessionId", "addMessage", "setLoading", "setError", "setSessionId", "onFormationReceived"]
        returns: ["submit"]
    props:
      ChatPanel: ["onClose", "onFormationReceived", "onNavigationStateChange", "hideFormation"]
      ChatHistory: ["messages", "isLoading", "hideFormation"]
      MessageBubble: ["message", "hideFormation"]
    session_persistence:
      storage: "localStorage"
      key: "chatSessionId"
      cache_key: "chatSessionCache"
      flow:
        - "On mount: check sessionCache (loadSessionCache), instant restore messages+formation"
        - "If cache hit: restore instantly, then validate with getSession() in background"
        - "If cache miss: check localStorage chatSessionId, call getSession()"
        - "If active: restore messages"
        - "If expired: clearSessionCache()"
        - "On message: save sessionId + messages + formation to cache (saveSessionCache)"
      cache_ttl: "30 minutes"
      cache_format: "{ sessionId, messages (sans formation blobs), formation, savedAt }"

  catalog:
    path: "src/features/catalog/"
    status: "implemented"
    files:
      - "catalogModel.js - createInitialCatalogState()"
      - "useCatalogProducts.js - Catalog state"
      - "ProductGrid.jsx - Product grid"
      - "ProductGrid.css - Styles"
    hooks:
      useCatalogProducts:
        params: ["tenantSlug"]
        returns: ["products", "total", "isLoading", "error", "filters", "loadProducts", "setFilters", "resetFilters"]

  overlay:
    path: "src/features/overlay/"
    status: "implemented"
    files:
      - "useOverlayState.js - { isOpen, open, close, toggle }"
      - "FullscreenOverlay.jsx"
      - "Overlay.css - Backdrop, layout, animations"
    features:
      - "Chat backdrop (dimmed overlay)"
      - "Widget display area (left side)"
      - "Chat area (right side)"
      - "Animations: backdrop-fade-in, chat-slide-in, widget-fade-in"

  navigation:
    path: "src/features/navigation/"
    status: "implemented"
    files:
      - "BackButton.jsx - Back navigation button"
      - "BackButton.css - Back button styles"
    components:
      BackButton:
        props: ["onClick", "visible"]
        purpose: "Navigate back from detail view to previous view"

  canvas:
    path: "src/features/canvas/"
    status: "placeholder"
    purpose: "Future: zoom, pan, widget navigation"

app:
  path: "src/App.jsx"
  state: ["isChatOpen: boolean", "activeFormation: Formation|null", "navState: { canGoBack, onExpand, onBack }"]
  components: ["ChatPanel", "FormationRenderer", "BackButton"]
  overlay_layout:
    - "Backdrop dims screen when chat open"
    - "Widget display area: left, shows BackButton + activeFormation"
    - "Chat area: right, ChatPanel with hideFormation=true"

pattern:
  - "Each feature: model.js + hooks + components"
  - "Hooks return object with state and actions"
  - "Components use hooks internally"

naming:
  models: "{feature}Model.js"
  hooks: "use{Feature}{Action}.js"
  components: "PascalCase.jsx"
  styles: "{Component}.css"

run_commands:
  install: "cd project/frontend && npm install"
  dev: "cd project/frontend && npm run dev"
  build: "cd project/frontend && npm run build"
  lint: "cd project/frontend && npm run lint"
