# Frontend Implementation Expertise
# Keepstar - React Feature-Sliced Architecture

overview:
  description: "React SPA for AI-powered chat widget with dynamic widget rendering"
  architecture: "Feature-Sliced Design"
  framework: "React 19"
  bundler: "Vite 7"
  language: "JavaScript (JSX)"
  styling: "CSS"
  dev_port: 5173
  api_proxy: "http://localhost:8080"

project_structure:
  root: "project/frontend/"
  entry_point: "src/main.jsx"

  # Текущий рабочий код (простая структура)
  active_code:
    app: "src/App.jsx"
    styles: "src/App.css"
    components: "src/components/"

  # Новая архитектура (stubs)
  feature_sliced:
    shared: "src/shared/"
    entities: "src/entities/"
    features: "src/features/"
    app: "src/app/"

layer_rules:
  description: "Направление: app → features → entities → shared"
  shared:
    imports: "Только внешние библиотеки"
    contains: "API client, hooks, UI компоненты, утилиты"
  entities:
    imports: "shared/"
    contains: "Бизнес-сущности: atom, widget, message"
  features:
    imports: "shared/, entities/"
    contains: "Фичи: chat, overlay, canvas"
  app:
    imports: "Всё"
    contains: "Entry point, providers, глобальные стили"

core_implementation:
  # Активный код
  active:
    app:
      file: "src/App.jsx"
      purpose: "Root component с чатом"
      state:
        - "isOpen: boolean - открыт ли чат"
      components_used:
        - "Chat"

    chat:
      file: "src/components/Chat.jsx"
      styles: "src/components/Chat.css"
      purpose: "Чат с AI ассистентом"
      state:
        - "messages: array - история сообщений"
        - "input: string - текущий ввод"
        - "isLoading: boolean"
      api_call: "POST /api/chat"

  # Feature-Sliced stubs
  feature_sliced:
    shared:
      api:
        directory: "src/shared/api/"
        files:
          apiClient:
            file: "apiClient.js"
            purpose: "HTTP client для backend"
            function: "sendChatMessage(sessionId, message)"

    entities:
      atom:
        directory: "src/entities/atom/"
        atomModel:
          file: "atomModel.js"
          exports: ["AtomType"]
          types: ["text", "number", "price", "image", "rating", "badge", "button"]

        AtomRenderer:
          file: "AtomRenderer.jsx"
          purpose: "Рендерит любой атом по типу"
          pattern: "switch (atom.type) → component"

      widget:
        directory: "src/entities/widget/"
        widgetModel:
          file: "widgetModel.js"
          exports: ["WidgetType", "FormationType"]

        WidgetRenderer:
          file: "WidgetRenderer.jsx"
          purpose: "Рендерит виджет из атомов"

      message:
        directory: "src/entities/message/"
        messageModel:
          file: "messageModel.js"
          exports: ["MessageRole"]

        MessageBubble:
          file: "MessageBubble.jsx"
          purpose: "Рендерит сообщение с виджетами"

    features:
      chat:
        directory: "src/features/chat/"
        chatModel:
          file: "chatModel.js"
          function: "createInitialChatState()"

        useChatMessages:
          file: "useChatMessages.js"
          returns: ["messages", "addMessage", "setLoading", "setError"]

        useChatSubmit:
          file: "useChatSubmit.js"
          returns: ["submit"]

        ChatPanel:
          file: "ChatPanel.jsx"
          purpose: "Основной компонент чата"

        ChatHistory:
          file: "ChatHistory.jsx"

        ChatInput:
          file: "ChatInput.jsx"

      overlay:
        directory: "src/features/overlay/"
        useOverlayState:
          file: "useOverlayState.js"
          returns: ["isOpen", "open", "close", "toggle"]

        FullscreenOverlay:
          file: "FullscreenOverlay.jsx"

      canvas:
        directory: "src/features/canvas/"
        status: "placeholder for future"

patterns:
  component_structure:
    - "Functional components с hooks"
    - "CSS файлы рядом с компонентами"
    - "Props передаются напрямую"

  hooks_pattern:
    - "use{Feature}{Action}.js"
    - "Возвращают объект с state и actions"

  naming:
    components: "PascalCase.jsx"
    hooks: "use{Name}.js"
    models: "{feature}Model.js"

run_commands:
  install: "cd project/frontend && npm install"
  dev: "cd project/frontend && npm run dev"
  build: "cd project/frontend && npm run build"

migration_status:
  active: "src/App.jsx + src/components/Chat.jsx"
  next_steps:
    - "Перевести на feature-sliced структуру"
    - "Добавить рендеринг виджетов"
